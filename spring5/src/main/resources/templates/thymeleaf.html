<!DOCTYPE html>
<html lang="ko" xmlns="http://www.thymeleaf.org"
                xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>thymeleaf</title>
</head>
<body>
    <h1>thymeleaf</h1>

    <!-- 로그인했을때만 실행 -->
    <div sec:authorize="isAuthenticated()">
        <p>로그인한 경우에만 보임</p>
        <!-- role_user 권한을 가지고 있다면 -->
        <p sec:authorize="hasRole('USER')">일반 사용자입니다.</p>
        <!-- role_admin 권한을 가지고 있다면 -->
        <p sec:authorize="hasRole('ADMIN')">관리자입니다.</p>

        <!-- 로그인한 아이디 -->
        <p sec:authentication="name"></p>
        <p sec:authentication="principal"></p>
        <p sec:authentication="principal.authorities"></p>

        <!-- 인증시 사용한 객체에 대한 정보 -->
        <p th:text="${#authentication}"></p>
        <p th:text="${#authentication.name}"></p>
        <p th:text="${#authentication.principal}"></p>
        <p th:text="${#authentication.principal.enabled}"></p>
        <p th:text="${#authentication.principal.authorities}"></p>

        <!-- 로그인한 아이디 확인 표현식 -->
        <p th:if="${#authentication.name == id}">ID는 ddd입니다.</p>
        <p th:if="${#authentication.name == 'ddd'}">ID는 ddd입니다.</p>
        <p th:if="${#authentication.name} == ${id}">ID는 ddd입니다.</p>
    </div>
    
    <!-- 로그인하지 않았을때만 실행 -->
    <div sec:authorize="not isAuthenticated()">
        <p>로그인 안한 경우에만 보임</p>
    </div>
</body>
</html>